(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{433:function(t,o,e){"use strict";e.r(o);var a=e(0),s=Object(a.a)({},(function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"淘宝-天猫单点登录分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#淘宝-天猫单点登录分析"}},[t._v("#")]),t._v(" 淘宝&天猫单点登录分析")]),t._v(" "),e("h2",{attrs:{id:"_1-登录淘宝，获取用户信息（cookie）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录淘宝，获取用户信息（cookie）"}},[t._v("#")]),t._v(" 1. 登录淘宝，获取用户信息（cookie）")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/44160914/105808163-34eb1000-5fe2-11eb-92bd-41a567226a87.png",alt:"image"}})]),t._v(" "),e("h2",{attrs:{id:"_2-f12打开控制台，-打开tmall-com，观察请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-f12打开控制台，-打开tmall-com，观察请求"}},[t._v("#")]),t._v(" 2.  F12打开控制台， 打开tmall.com，观察请求")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/44160914/105806478-0c154b80-5fdf-11eb-9610-6b9964d36d85.png",alt:"image"}})]),t._v(" "),e("h2",{attrs:{id:"_3-可以看到存在login-api的jsonp请求，该请求发送到top-tmm-taobao-com。该请求会自动携带domain为-taobao-com的cookie【因为samesite为none】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-可以看到存在login-api的jsonp请求，该请求发送到top-tmm-taobao-com。该请求会自动携带domain为-taobao-com的cookie【因为samesite为none】"}},[t._v("#")]),t._v(" 3. 可以看到存在login_api的jsonp请求，该请求发送到top-tmm.taobao.com。该请求会自动携带domain为"),e("code",[t._v(".taobao.com")]),t._v("的cookie【因为SameSite为None】")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/44160914/105807401-e1c48d80-5fe0-11eb-914d-fd0f18b6320b.png",alt:"image"}})]),t._v(" "),e("h2",{attrs:{id:"_4-jsonp的返回结果为taobao-com域下的cookie信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-jsonp的返回结果为taobao-com域下的cookie信息"}},[t._v("#")]),t._v(" 4.  jsonp的返回结果为taobao.com域下的cookie信息")]),t._v(" "),e("p",[e("strong",[t._v("这里的jsonp要保证是从tmall.com发送的jsonp请求")])]),t._v(" "),e("p",[e("strong",[t._v("请求头：referer: https://www.tmall.com/")]),t._v("【该请求头可以伪造，暂未搞懂怎么保障安全的】")]),t._v(" "),e("blockquote",[e("ul",[e("li",[e("strong",[t._v("另类方案")]),t._v("：采用cors携带cookie跨域请求sso服务，请求的时候配置"),e("strong",[t._v("withCredentials：true")]),t._v(" ；同时服务器响应头配置"),e("strong",[t._v("Access-Control-Allow-Credentials：true")]),t._v("  与 "),e("strong",[t._v("Access-Control-Allow-Origin不为")]),t._v("*【注意：SameSite也不能为None】")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://zhulijun.club/front-end/http/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%E4%B8%8E%E8%B7%A8%E5%9F%9F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html#%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E6%90%BA%E5%B8%A6cookie%E6%96%B9%E6%A1%88",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见：跨域请求携带cookie方案"),e("OutboundLink")],1)])])]),t._v(" "),e("h2",{attrs:{id:"_5-获取到cookie信息后发送到tmall的服务后台，校验后再set-cookie在tmall-com的域名下面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-获取到cookie信息后发送到tmall的服务后台，校验后再set-cookie在tmall-com的域名下面"}},[t._v("#")]),t._v(" 5. 获取到cookie信息后发送到tmall的服务后台，校验后再set cookie在tmall.com的域名下面")])])}),[],!1,null,null,null);o.default=s.exports}}]);