(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{434:function(e,o,t){"use strict";t.r(o);var a=t(0),s=Object(a.a)({},(function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"深入了解一下cookie"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#深入了解一下cookie"}},[e._v("#")]),e._v(" 深入了解一下cookie")]),e._v(" "),t("p",[t("strong",[e._v("后端设置cookie：响应头Set-Cookie")]),e._v(" "),t("strong",[e._v("前端操作cookie：document.cookie")])]),e._v(" "),t("h2",{attrs:{id:"cookie字段说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cookie字段说明"}},[e._v("#")]),e._v(" cookie字段说明")]),e._v(" "),t("h3",{attrs:{id:"name-value"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#name-value"}},[e._v("#")]),e._v(" name/value")]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"domain"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#domain"}},[e._v("#")]),e._v(" Domain")]),e._v(" "),t("p",[e._v("设置cookie可以送达的主机名(默认为当前主机)")]),e._v(" "),t("blockquote",[t("p",[e._v("例如设置为 .taobao.com，则xxx.taobao.com有效")])]),e._v(" "),t("blockquote",[t("p",[e._v("跨域设置无效，例如：Set-Cookie: qwerty=219ffwef9w0f; Domain=baidu.com;")])]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("注意")]),e._v(" "),t("p",[t("strong",[e._v("Cookie的作用域不区分协议和端口")]),e._v("，参考：http://blog.haoji.me/cookie-scope.html")])]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"path"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#path"}},[e._v("#")]),e._v(" Path")]),e._v(" "),t("p",[e._v("设置URL中必须包含该路径才会发送该条cookie信息")]),e._v(" "),t("h3",{attrs:{id:"domain-和-path-标识共同定义了-cookie-的作用域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#domain-和-path-标识共同定义了-cookie-的作用域"}},[e._v("#")]),e._v(" (Domain 和 Path 标识共同定义了 Cookie 的作用域)")]),e._v(" "),t("blockquote",[t("p",[e._v("例如设置Path=/docs，则发送请求时/docs/xxx才会携带该cookie")])]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"expires"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#expires"}},[e._v("#")]),e._v(" Expires")]),e._v(" "),t("p",[e._v("设置cookie过期时间(根据本地时间)")]),e._v(" "),t("blockquote",[t("p",[e._v("示例：Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT;")])]),e._v(" "),t("blockquote",[t("p",[e._v("缺少Expires字段时表示会话性cookie，关闭浏览器失效")])]),e._v(" "),t("h3",{attrs:{id:"max-age"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#max-age"}},[e._v("#")]),e._v(" Max-Age")]),e._v(" "),t("p",[e._v("设置cookie在指定秒后过期(优先级高于Expires)")]),e._v(" "),t("blockquote",[t("p",[e._v("Set-Cookie: id=a3fWa; Max-Age=604800;")])]),e._v(" "),t("blockquote",[t("p",[e._v("为负数是表示为会话性cookie")])]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"secure"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#secure"}},[e._v("#")]),e._v(" Secure")]),e._v(" "),t("p",[e._v("标记Secure的cookie只会通过https才会发送")]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"httponly"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#httponly"}},[e._v("#")]),e._v(" HTTPOnly")]),e._v(" "),t("p",[e._v("阻止客户端通过document.cookie访问cookie。【防止XSS(跨站脚本攻击)】")]),e._v(" "),t("hr"),e._v(" "),t("h3",{attrs:{id:"samesite-在跨站请求时不发送cookie【阻止csrf-跨站请求伪造-攻击】"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samesite-在跨站请求时不发送cookie【阻止csrf-跨站请求伪造-攻击】"}},[e._v("#")]),e._v(" SameSite 在跨站请求时不发送Cookie【阻止CSRF(跨站请求伪造)攻击】")]),e._v(" "),t("blockquote",[t("p",[e._v("参考: "),t("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cookie 的 SameSite 属性"),t("OutboundLink")],1)])]),e._v(" "),t("blockquote",[t("ul",[t("li",[e._v("Strict 请求URL与网页URL完全一致cookie才会被发送")]),e._v(" "),t("li",[e._v("Lax 允许部分第三方请求携带cookie（chrome80的默认值）")]),e._v(" "),t("li",[e._v("None 无论跨站都会发送cookie（chrome80之前的版本默认值）")])])]),e._v(" "),t("h2",{attrs:{id:"dom标签跨域发送cookie的场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dom标签跨域发送cookie的场景"}},[e._v("#")]),e._v(" Dom标签跨域发送cookie的场景")]),e._v(" "),t("p",[t("strong",[e._v("前提条件：cookie的SameSite属性为None")])]),e._v(" "),t("h3",{attrs:{id:"常见规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见规则"}},[e._v("#")]),e._v(" 常见规则")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://user-images.githubusercontent.com/44160914/108799132-7b746000-75ca-11eb-943c-6cc950d81313.png",alt:"image"}})]),e._v(" "),t("h3",{attrs:{id:"cookie的samesite属性设置为none必须同时设置secure，否则不会生效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cookie的samesite属性设置为none必须同时设置secure，否则不会生效"}},[e._v("#")]),e._v(" cookie的SameSite属性设置为None必须同时设置Secure，否则不会生效")]),e._v(" "),t("blockquote",[t("ul",[t("li",[e._v("Set-Cookie: widget_session=abc123; SameSite=None; Secure")])])])])}),[],!1,null,null,null);o.default=s.exports}}]);